---
layout: homework
title: "Homework #9"
---
<style>
.hl {
	background-color: yellow;
}
img {
    border: 1px solid #000;
}

.warning {
    background-color: yellow;
    color: #aa1122;
    font-weight: bold;
}

.hidden {
    display: none;
}

.hintButton {
    color: #7788ff;
    cursor: pointer;
}

.background {
	background-color: #eeffee;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', hideHints);

function hideHints(evt) {
    document.querySelectorAll('.hint').forEach((ele, i) => {
        const div = document.createElement('div');
		const label = ele.getAttribute('data-name');
        div.id = 'hint' + i + 'Button';
        ele.id = 'hint' + i;
        ele.classList.add('hidden');
        div.addEventListener('click', onClick);
        div.textContent = `Show ${label}`;
        div.className = 'hintButton';
        ele.parentNode.insertBefore(div, ele);
    });

}

function onClick(evt) {
    const hintId = this.id.replace('Button', '');
    const hint = document.getElementById(hintId);
    hint.classList.toggle('hidden');
	const label = hint.getAttribute('data-name');
    this.textContent = this.textContent === `Show ${label}` ? `Hide ${label}` : `Show ${label}`;
}
</script>

# In-Class Workshop (Homework #09) - MongoDB

__Overview__


1. Import csv data into MongoDB
2. Run a few queries on the resulting dataset through MongoDB


__Submissions__

* work in groups of around 5 (groups will be randomly assigned through zoom's breakout rooms)
* __each group only has to turn in one form__ (make sure the netids of all group members are included)
* ⚠️ submit by using the form at the end of the instructions

__Grading__

* +65: attended and submitted form
* +20: reasonable attempts made for most queries
* +10: second to last query attempted, and general approach is correct
* +5: last query attempted, and general approach is correct

## Part 1: MongoDB Data Import, Queries

### Load Sample Data

1. Download [the latest `listings.csv.gz` data for __New York City__](http://insideairbnb.com/get-the-data.html)
	* Make sure the data that you're using is __New York City__ (there are several cities listed)
2. The file is compressed; extract the data on i6 by using this command: `gunzip listings.csv.gz`
3. Use `mongoimport` to bring in the json data
	* use __hw09__ as the database and `listings` as the collection name
	* `mongoimport  --headerline --type=csv --db=hw09  --collection=listings --file=listings.csv` 
	* this import will take a few minutes
	* you may seem some "quota exceeded" errors interspersed between progress status; this is ok
	* there should be ~30k records inserted

### Query Sample Data

Use the `mongo` commandline client to run the following queries... __save both the query and the first two lines of the result in a text file__:

1. show exactly two documents from the `listings` collection in any order
2. show exactly 10 documents in any order... but print in easier to read format and noting the host names for further use
3. choose two host names... and show all of the listings hosted by either of the two hosts (for example, "Kamilla" or "Sonder"... though these two names may not exist in the _latest_ data set)
	* only show the `name`, `price`, `neighbourhood`, and `host_name`
4. find all of the unique `host_name` ([see the docs](https://docs.mongodb.com/manual/reference/method/db.collection.distinct/))
5. find all of the places that have more than 2 `beds` in `city` (referred to as `neighbourhood_group_cleansed` in json file) Brooklyn, ordered by `review_scores_rating` descending
	* only show the `name`, `beds`, `city`, `review_scores_rating`, and `price`
	* if you run out of memory for this query, try filtering `review_scores_rating` that aren't empty (`$ne`)... and lastly, if there's still an issue, you can set beds to exactly 2
6. show the number of listings per host
7. in `city` (again, use neighbourhood_group_cleansed), Manhattan, find the average `review_scores_rating` per `neighbourhood`, and only show the ones above a 95... sorted in descending order of rating ([see the docs](https://docs.mongodb.com/manual/reference/operator/aggregation/sort/))

## Submit the Lab

* ⚠️you must be logged in to your NYU google account to see the form
* ⚠️ a single form submission per group is adequate

[https://forms.gle/cSm2Q9djz86vSbA79](https://forms.gle/BeoWbM1ut2gwjnZ9A)

